/* styles.css - MAX liquid glass, gradients, glows, and animations */
:root{
	/* Apple-style liquid glass/* vibrant liquid glass wallpaper */
	--wallpaper-url: url('https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80');

	/* Use the vibrant wallpaper directly as background */
	--bg: var(--wallpaper-url);

	/* Advanced liquid glass with SVG distortion */
	--panel: rgba(255,255,255,0.25);   /* main glass layer */
	--panel-2: rgba(255,255,255,0.08); /* depth layer */
	--glass-blur: 3px;                 /* subtle blur for distortion */
	--glass-highlight: rgba(255,255,255,0.50); /* strong light dispersion */
	--glass-sheen: rgba(255,255,255,0.30);     /* light refraction */
	--glass-backlight: radial-gradient(ellipse at 30% 25%, rgba(255,255,255,0.25), rgba(255,255,255,0.00) 60%);
	--glass-border: rgba(255,255,255,0.18);
	--glass-glow: 0 80px 240px rgba(255,255,255,0.12);
	--liquid-anim-duration: 16s;
	--sheen-duration: 8s;

/* SVG glass distortion filter - realistic liquid glass */
svg { display: none; }

/* Advanced liquid glass panel structure */
.liquidGlass-panel {
	position: relative;
	overflow: hidden;
	box-shadow: 0 6px 6px rgba(0, 0, 0, 0.2), 0 0 20px rgba(0, 0, 0, 0.1);
	transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 2.2);
}

.liquidGlass-effect {
	position: absolute;
	z-index: 0;
	inset: 0;
	backdrop-filter: blur(var(--glass-blur));
	filter: url(#glass-distortion);
	overflow: hidden;
	isolation: isolate;
}

.liquidGlass-tint {
	z-index: 1;
	position: absolute;
	inset: 0;
	background: var(--panel);
}

.liquidGlass-shine {
	position: absolute;
	inset: 0;
	z-index: 2;
	overflow: hidden;
	box-shadow: inset 2px 2px 1px 0 rgba(255, 255, 255, 0.5),
		inset -1px -1px 1px 1px rgba(255, 255, 255, 0.5);
}

.liquidGlass-content {
	z-index: 3;
	position: relative;
}

/* Live liquid glass animations */
@keyframes liquidLightDispersion {
	0% { background-position: 0% 50%; }
	25% { background-position: 100% 25%; }
	50% { background-position: 100% 75%; }
	75% { background-position: 0% 100%; }
	100% { background-position: 0% 50%; }
}

@keyframes liquidRefraction {
	0% { transform: translateX(0) translateY(0) rotate(0deg); }
	25% { transform: translateX(10px) translateY(-5px) rotate(1deg); }
	50% { transform: translateX(-5px) translateY(10px) rotate(-1deg); }
	75% { transform: translateX(-10px) translateY(-8px) rotate(0.5deg); }
	100% { transform: translateX(0) translateY(0) rotate(0deg); }
}

@keyframes liquidDepthFlow {
	0% { backdrop-filter: blur(40px) saturate(1.2); }
	33% { backdrop-filter: blur(60px) saturate(1.4); }
	66% { backdrop-filter: blur(45px) saturate(1.1); }
	100% { backdrop-filter: blur(40px) saturate(1.2); }
}

	/* Evenly distributed, centered radial background (balanced, pleasant lighting) */
	--text:#041025;
	--muted:#4b5563;
	--accent1:#8b5cf6; /* purple */
	--accent2:#06b6d4; /* cyan */
	--accent3:#ff7ab6; /* pink */
	--radius:22px;
	--shadow:0 30px 120px rgba(10,20,40,0.08);
	--transition-fast:200ms cubic-bezier(.2,.9,.3,1);

	/* faint backlight to make liquid glass appear softly lit from behind */
	--glass-backlight: radial-gradient(circle at 20% 12%, rgba(255,255,255,0.14), rgba(255,255,255,0.00) 36%);
}
:root[data-theme="dark"]{
	/* Dark mode with deep space gradient overlay */
	--bg: linear-gradient(135deg,
		rgba(0,10,20,0.8) 0%,
		rgba(0,15,30,0.6) 30%,
		rgba(0,20,40,0.4) 70%,
		rgba(0,5,15,0.9) 100%),
		var(--wallpaper-url);

	/* Dark-mode liquid glass: subtle translucence with strong blur */
	--panel: rgba(15,25,35,0.25);
	--panel-2: rgba(10,20,30,0.12);
	--glass-blur: 100px;
	--glass-highlight: rgba(255,255,255,0.08);
	--glass-border: rgba(255,255,255,0.12);
	--glass-glow: 0 80px 240px rgba(99,102,241,0.18);

	--text:#e8f4ff;
	--muted:#b8d4e8;
	--accent1:#8b5cf6;
	--accent2:#06b6d4;
	--accent3:#ff7ab6;
	--radius:24px;
	--shadow:0 50px 200px rgba(0,0,0,0.8);

	/* Enhanced backlight for dark mode panels */
	--glass-backlight: radial-gradient(circle at 15% 10%, rgba(139,92,246,0.12), rgba(6,182,212,0.08), rgba(255,255,255,0.00) 45%);
}

/* Full viewport layout */
*{box-sizing:border-box}
/* ensure the image is used directly, covers the viewport and does not repeat */
html,body{
  height:100%;
  width:100%;
  margin:0;
  font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans Sinhala',sans-serif;
  color:var(--text);
  background-image: var(--bg);
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  overflow:hidden;
}
body{display:flex;align-items:stretch;justify-content:center}
.app{ --sidebar-w:360px; width:100vw;height:100vh;display:grid;grid-template-columns: var(--sidebar-w) 1fr;grid-template-rows:120px 1fr;grid-template-areas:"sidebar header" "sidebar main";gap:28px;padding:28px;overflow:hidden;transition: grid-template-columns 420ms cubic-bezier(.2,.9,.3,1);position:relative;}
.app::before{content:'';position:absolute;inset:0;z-index:0;backdrop-filter:blur(var(--glass-blur));filter:url(#glass-distortion);overflow:hidden;isolation:isolate;border-radius:var(--radius);background:var(--panel);}
.app::after{content:'';position:absolute;inset:0;z-index:1;box-shadow:inset 2px 2px 1px 0 rgba(255,255,255,0.5),inset -1px -1px 1px 1px rgba(255,255,255,0.5);border-radius:var(--radius);pointer-events:none;}
.app > *{position:relative;z-index:2;}

@media (max-width:900px){
  .app{grid-template-columns:1fr;grid-template-rows:96px 1fr 420px;grid-template-areas:"header" "main" "sidebar";padding:16px}
  .sidebar{height:420px}
}

/* Enhanced animated background layer with parallax */
.background-layer{
  position:fixed;
  inset:0;
  z-index:-2;
  pointer-events:none;
  background-image: var(--wallpaper-url);
  background-size: cover;
  background-position: center center;
  filter: brightness(1.1) contrast(1.05) saturate(1.1);
  opacity: 0.6;
  transform: translateZ(0);
  /* Enhanced liquid movement with more organic flow */
  animation: bg-liquid-flow var(--liquid-anim-duration) ease-in-out infinite;
  will-change: transform, filter;
}

/* Enhanced organic liquid flow animation */
@keyframes bg-liquid-flow {
  0%   { transform: scale(1.02) translate3d(-8px, 4px, 0) rotate(0.5deg); }
  20%  { transform: scale(1.03) translate3d(12px, -8px, 0) rotate(-0.3deg); }
  40%  { transform: scale(1.04) translate3d(-6px, 12px, 0) rotate(0.7deg); }
  60%  { transform: scale(1.035) translate3d(14px, -4px, 0) rotate(-0.4deg); }
  80%  { transform: scale(1.025) translate3d(-10px, 8px, 0) rotate(0.2deg); }
  100% { transform: scale(1.02) translate3d(-8px, 4px, 0) rotate(0.5deg); }
}

/* Header with perfect liquid glass */
.app-header{grid-area:header;display:flex;align-items:center;justify-content:space-between;padding:22px;border-radius:var(--radius);position:relative;overflow:hidden;}
.app-header::before{content:'';position:absolute;z-index:0;inset:0;backdrop-filter:blur(var(--glass-blur));filter:url(#glass-distortion);overflow:hidden;isolation:isolate;border-radius:var(--radius);}
.app-header::after{content:'';position:absolute;z-index:1;inset:0;background:linear-gradient(180deg,rgba(255,255,255,0.28),rgba(255,255,255,0.22));box-shadow:inset 2px 2px 1px 0 rgba(255,255,255,0.45),inset -1px -1px 1px 1px rgba(255,255,255,0.35);border-radius:var(--radius);}
.app-header > *{position:relative;z-index:2;}
:root[data-theme="dark"] .app-header::after {
	background: linear-gradient(180deg, rgba(255,255,255,0.32), rgba(255,255,255,0.24));
	box-shadow: inset 2px 2px 1px 0 rgba(255,255,255,0.55), inset -1px -1px 1px 1px rgba(255,255,255,0.45);
}
.brand{display:flex;align-items:center;gap:16px}
.logo{width:64px;height:64px;border-radius:16px;background:linear-gradient(135deg,var(--accent1),var(--accent2));box-shadow:var(--glass-glow);display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
.brand-title{font-size:24px;margin:0;background:linear-gradient(90deg,var(--accent1),var(--accent2),var(--accent3));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;font-weight:800;text-shadow:0 6px 40px rgba(99,102,241,0.06)}
.subtitle{font-size:13px;color:var(--muted);margin-top:6px}
.header-actions{display:flex;align-items:center;gap:12px}

/* Enhanced dropdown animations with Smart Animate style */
.select{appearance:none;padding:12px 14px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.06);color:var(--text);min-width:180px;cursor:pointer;backdrop-filter:blur(12px);box-shadow:0 6px 30px rgba(0,0,0,0.06);position:relative;transition:all 300ms cubic-bezier(.2,.9,.3,1);transform-origin:top}
.select:focus{outline:0;box-shadow:0 8px 40px rgba(99,102,241,0.12);transform:scale(1.02) translateY(-2px);border-color:rgba(99,102,241,0.2)}
.select:hover{transform:scale(1.01) translateY(-1px);box-shadow:0 8px 35px rgba(99,102,241,0.08)}

/* Dropdown arrow animation */
.select::after{content:'â–¼';position:absolute;right:14px;top:50%;transform:translateY(-50%);font-size:10px;color:var(--muted);transition:transform 300ms cubic-bezier(.2,.9,.3,1);pointer-events:none}
.select:focus::after{transform:translateY(-50%) rotate(180deg)}

/* Original sidebar design with perfect liquid glass panel */
.sidebar{grid-area:sidebar;border-radius:var(--radius);padding:40px;display:flex;flex-direction:column;gap:24px;position:relative;overflow:hidden;box-shadow:0 6px 6px rgba(0, 0, 0, 0.2), 0 0 20px rgba(0, 0, 0, 0.1);transition:all 0.4s cubic-bezier(0.175, 0.885, 0.32, 2.2);transform-origin:left center;}
.sidebar .liquidGlass-effect{position:absolute;z-index:0;inset:0;backdrop-filter:blur(var(--glass-blur));filter:url(#glass-distortion);overflow:hidden;isolation:isolate;}
.sidebar .liquidGlass-tint{z-index:1;position:absolute;inset:0;background:var(--panel);}
.sidebar .liquidGlass-shine{position:absolute;inset:0;z-index:2;overflow:hidden;box-shadow:inset 2px 2px 1px 0 rgba(255,255,255,0.5),inset -1px -1px 1px 1px rgba(255,255,255,0.5);}
.sidebar .liquidGlass-content{z-index:3;position:relative;display:flex;flex-direction:column;height:100%;}
.sidebar.hidden{transform:translateX(-120%) scale(0.95);opacity:0;pointer-events:none;filter:blur(8px)}
.sidebar::before{content:'';position:absolute;inset:0;border-radius:var(--radius);background:linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);opacity:0;transition:opacity 300ms ease;pointer-events:none}
.sidebar:hover::before{opacity:1}
.section-title{font-size:12px;color:var(--muted);padding:6px 8px}
.sidebar-footer{margin-top:auto}
/* Enhanced language toggle with compact design */
.lang-toggle{display:flex;gap:6px;padding:3px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);backdrop-filter:blur(8px)}
.lang-toggle button{padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);color:var(--text);cursor:pointer;box-shadow:0 8px 32px rgba(0,0,0,0.04);transition:all 300ms cubic-bezier(.2,.9,.3,1);position:relative;overflow:hidden;font-size:13px;}
.lang-toggle button::before{content:'';position:absolute;inset:0;background:linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);transform:translateX(-100%);transition:transform 600ms ease}
.lang-toggle button:hover::before{transform:translateX(100%)}
.lang-toggle button[aria-selected="true"]{background:linear-gradient(90deg, rgba(139,92,246,0.12), rgba(6,182,212,0.08));box-shadow:0 18px 80px rgba(99,102,241,0.08);border-color:rgba(99,102,241,0.12);transform:scale(1.02)}
.history-list{flex:1;overflow:auto;padding-right:4px;display:flex;flex-direction:column;gap:12px}
.history-item{padding:12px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border:1px solid rgba(255,255,255,0.02);cursor:pointer;transition:transform var(--transition-fast),box-shadow var(--transition-fast);font-size:13px;}
.history-item:hover{transform:translateY(-2px);box-shadow:0 12px 40px rgba(0,0,0,0.08)}
.history-item[aria-selected="true"]{background:linear-gradient(90deg, rgba(139,92,246,0.08), rgba(6,182,212,0.04));box-shadow:var(--glass-glow)}

/* Sidebar spacing and footer pin */
.sidebar{padding:40px;gap:24px}
.sidebar-content{flex:1;display:flex;flex-direction:column;gap:22px;overflow:auto;padding-right:8px}
.sidebar-footer{display:flex;gap:12px;align-items:center;justify-content:space-between;padding-top:12px}

/* Input field styling */
.input{flex:1;padding:14px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));color:var(--text);box-shadow:inset 0 6px 24px rgba(0,0,0,0.08), 0 12px 60px rgba(0,0,0,0.06);transition:box-shadow 220ms,transform 220ms;font-size:15px}
.input::placeholder{color:rgba(7,16,36,0.4)}
.input:focus{outline:none;box-shadow:0 12px 60px rgba(99,102,241,0.12), inset 0 6px 28px rgba(0,0,0,0.09);transform:translateY(-2px);border:1px solid rgba(99,102,241,0.12)}

/* Ensure input readability in dark */
:root[data-theme="dark"] .input{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));color:var(--text);border:1px solid rgba(255,255,255,0.03)}
:root[data-theme="dark"] .input::placeholder{color:rgba(234,246,255,0.4)}

/* Clear button theme-aware color - use currentColor so icon inherits */
.btn-clear{display:inline-flex;align-items:center;gap:8px;padding:12px 14px;border-radius:12px;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.06);color:var(--text)}
:root[data-theme="dark"] .btn-clear{color:#ffffff}
:root:not([data-theme="dark"]) .btn-clear{color:#071023}
.btn-clear .btn-icon{display:inline-block}

/* Bottom buttons */
.btn-primary, .btn-clear{padding:12px 14px;border-radius:12px;border:none;cursor:pointer;font-weight:700}
.btn-primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;box-shadow:0 18px 80px rgba(99,102,241,0.12);transition:transform var(--transition-fast),box-shadow var(--transition-fast)}
.btn-primary:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 28px 140px rgba(99,102,241,0.16)}
.btn-clear{display:inline-flex;align-items:center;gap:8px;padding:12px 14px;border-radius:12px;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.06);color:var(--text)}
:root[data-theme="dark"] .btn-clear{color:#ffffff}
:root:not([data-theme="dark"]) .btn-clear{color:#071023}
.btn-clear .btn-icon{display:inline-block}

/* Chat area with fixed bottom input */
.chat{grid-area:main;border-radius:var(--radius);display:flex;flex-direction:column;position:relative;overflow:hidden;box-shadow:0 6px 6px rgba(0, 0, 0, 0.2), 0 0 20px rgba(0, 0, 0, 0.1);transition:all 0.4s cubic-bezier(0.175, 0.885, 0.32, 2.2);}
.chat .liquidGlass-effect{position:absolute;z-index:0;inset:0;backdrop-filter:blur(var(--glass-blur));filter:url(#glass-distortion);overflow:hidden;isolation:isolate;}
.chat .liquidGlass-tint{z-index:1;position:absolute;inset:0;background:var(--panel);}
.chat .liquidGlass-shine{position:absolute;inset:0;z-index:2;overflow:hidden;box-shadow:inset 2px 2px 1px 0 rgba(255,255,255,0.5),inset -1px -1px 1px 1px rgba(255,255,255,0.5);}
.chat .liquidGlass-content{z-index:3;position:relative;display:flex;flex-direction:column;height:100%;}
.chat-header{padding:22px 22px 0 22px;display:flex;align-items:center;justify-content:space-between;flex-shrink:0;}
.chat-title{font-weight:800;font-size:20px}
.chat-subtitle{font-size:13px;color:var(--muted);opacity:0.95}
.messages{flex:1;overflow:auto;padding:18px 22px;display:flex;flex-direction:column;gap:18px;scrollbar-width:thin}
/* Composer with liquid glass inside chat - scaled properly */
.composer{padding:12px 18px 18px 18px;flex-shrink:0;position:relative;margin:0 22px 22px 22px;}
.composer{position:relative;overflow:hidden;border-radius:14px;background:transparent;display:flex;gap:12px;align-items:center;}
.composer::before{content:'';position:absolute;z-index:0;inset:0;backdrop-filter:blur(var(--glass-blur));filter:url(#glass-distortion);overflow:hidden;isolation:isolate;border-radius:14px;}
.composer::after{content:'';position:absolute;z-index:1;inset:0;background:linear-gradient(180deg,rgba(255,255,255,0.28),rgba(255,255,255,0.22));box-shadow:inset 2px 2px 1px 0 rgba(255,255,255,0.45),inset -1px -1px 1px 1px rgba(255,255,255,0.35);border-radius:14px;}
.composer > *{position:relative;z-index:2;}
:root[data-theme="dark"] .composer::after {
	background: linear-gradient(180deg, rgba(255,255,255,0.32), rgba(255,255,255,0.24));
	box-shadow: inset 2px 2px 1px 0 rgba(255,255,255,0.55), inset -1px -1px 1px 1px rgba(255,255,255,0.45);
}
.msg{max-width:78%;padding:16px 20px;border-radius:18px;box-shadow:0 12px 60px rgba(2,6,12,0.08);white-space:pre-wrap;line-height:1.5;font-weight:normal;opacity:0;transform:translateY(20px) scale(0.95);transition:all 600ms cubic-bezier(.2,.9,.3,1)}
.msg.user{margin-left:auto;position:relative;overflow:hidden;border-bottom-right-radius:6px;color:var(--text);background:
    var(--glass-backlight),
    linear-gradient(180deg, var(--glass-highlight), rgba(255,255,255,0.00)),
    linear-gradient(180deg, var(--panel), var(--panel-2));backdrop-filter:blur(var(--glass-blur));border:1px solid var(--glass-border);box-shadow:var(--shadow);}
:root[data-theme="dark"] .msg.user {
	background:
    var(--glass-backlight),
    linear-gradient(180deg, var(--glass-highlight), rgba(255,255,255,0.00)),
    linear-gradient(180deg, var(--panel), var(--panel-2));
}
.msg.ai{margin-right:auto;position:relative;overflow:hidden;border-bottom-left-radius:6px;color:var(--text);background:
    var(--glass-backlight),
    linear-gradient(180deg, var(--glass-highlight), rgba(255,255,255,0.00)),
    linear-gradient(180deg, var(--panel), var(--panel-2));backdrop-filter:blur(var(--glass-blur));border:1px solid var(--glass-border);box-shadow:var(--shadow);}

.msg.show{opacity:1;transform:translateY(0) scale(1)}
.msg:nth-child(odd){transition-delay:100ms}
.msg:nth-child(even){transition-delay:200ms}
.msg:nth-child(3n){transition-delay:300ms}

/* Chat bubble entry animation */
.msg.enter{opacity:0;transform:translateY(14px) scale(.98)}
.msg.enter.show{opacity:1;transform:none;transition:opacity 420ms cubic-bezier(.2,.9,.3,1),transform 420ms cubic-bezier(.2,.9,.3,1)}

/* Neon text glow for dark mode */
:root[data-theme="dark"] .brand-title{background:linear-gradient(90deg,var(--accent1),var(--accent2),var(--accent3));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;color:transparent;text-shadow:0 12px 40px rgba(99,102,241,0.14),0 2px 8px rgba(6,182,212,0.06)}
:root[data-theme="dark"] .chat-title, :root[data-theme="dark"] .msg{color:var(--text);text-shadow:0 6px 30px rgba(99,102,241,0.06),0 2px 8px rgba(6,182,212,0.04)}

/* Buttons shimmer */
@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
.btn-primary{position:relative;overflow:hidden}
.btn-primary::after{content:'';position:absolute;left:-120%;top:0;height:100%;width:220%;background:linear-gradient(90deg,rgba(255,255,255,0.06),rgba(255,255,255,0.12),rgba(255,255,255,0.06));transform:skewX(-18deg);opacity:0;transition:opacity 420ms,transform 420ms}
.btn-primary:hover::after{left: -20%;opacity:1;transform:skewX(-18deg) translateX(0)}

/* Button bounce animation (apply to hover in both themes) */
@keyframes btn-bounce {
  0% { transform: translateY(0); }
  30% { transform: translateY(-8px); }
  60% { transform: translateY(0); }
  100% { transform: translateY(0); }
}

.btn-primary:hover,
.btn-clear:hover,
.send:hover,
.icon-btn:hover {
  /* Remove conflicting transforms from earlier rules by overriding here */
  transform: none; /* animation will handle movement */
  animation: btn-bounce 420ms cubic-bezier(.2,.9,.3,1);
  /* Keep a consistent, slightly stronger hover shadow */
  box-shadow: 0 28px 120px rgba(99,102,241,0.12);
  /* Ensure background/gradient stays visible */
  background-image: linear-gradient(90deg,var(--accent1),var(--accent2));
}

@media (prefers-reduced-motion: reduce){
  .btn-primary:hover,
  .btn-clear:hover,
  .send:hover,
  .icon-btn:hover { animation: none; transform: none; }
}

/* Sidebar toggle styles */
.sidebar-toggle{font-size:18px;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 12px 60px rgba(99,102,241,0.06);cursor:pointer;transition:transform var(--transition-fast),box-shadow var(--transition-fast);color:var(--text)}
.sidebar-toggle:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 40px 200px rgba(99,102,241,0.18)}

/* Toasts */
.toast-wrap{position:fixed;right:28px;bottom:28px;display:flex;flex-direction:column;gap:12px;z-index:999}
.toast{min-width:280px;padding:14px 16px;border-radius:12px;background:linear-gradient(90deg,rgba(0,0,0,0.72),rgba(0,0,0,0.5));color:white;box-shadow:0 14px 60px rgba(0,0,0,0.5);opacity:0;transform:translateY(18px);animation:toast-in 320ms forwards}
@keyframes toast-in{to{opacity:1;transform:none}}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{transition:none!important;animation:none!important}
}

/* Enhanced accessibility with high contrast and focus states */
.sr{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}

/* Focus indicators for keyboard navigation */
button:focus-visible,
select:focus-visible,
input:focus-visible,
[tabindex]:focus-visible{
  outline:3px solid rgba(99,102,241,0.6);
  outline-offset:2px;
  border-radius:8px;
}

/* High contrast mode support */
@media (prefers-contrast: high){
  :root{
    --text:#000000;
    --muted:#333333;
    --glass-border:rgba(0,0,0,0.3);
    --panel:rgba(255,255,255,0.9);
  }
  :root[data-theme="dark"]{
    --text:#ffffff;
    --muted:#cccccc;
    --glass-border:rgba(255,255,255,0.3);
    --panel:rgba(0,0,0,0.7);
  }
}

/* Enhanced mobile responsiveness with touch-friendly sizing */
@media (max-width:480px){
  .app{padding:12px;gap:12px}
  .logo{width:48px;height:48px}
  .select{min-width:140px;padding:10px 12px;font-size:14px}
  .messages{padding:12px}
  .msg{max-width:85%;padding:12px 16px;font-size:14px}
  .sidebar{padding:20px;gap:16px}
  .lang-toggle button{padding:8px 10px;font-size:12px}
  .composer{padding:12px;gap:8px}
  .input{padding:12px;font-size:14px}
  .icon-btn, .send{min-width:40px;height:40px}
  
  /* Touch-friendly tap targets */
  button, .select, input{
    min-height:44px;
  }
}

/* Remove default scrollbars where not needed; allow overflow only when necessary */
html,body{overflow:hidden}
.app{overflow:hidden}
/* Sidebar should not scroll by default; give it breathing room */
.sidebar, .sidebar-content{overflow:visible}
/* Keep messages scrollable when chat grows */
.messages{overflow:auto;scrollbar-width:thin}

/* Ensure webkit scrollbars only appear for messages, not sidebar */
.messages::-webkit-scrollbar{width:10px}
.messages::-webkit-scrollbar-thumb{background:linear-gradient(180deg,rgba(0,0,0,0.08),rgba(0,0,0,0.06));border-radius:8px}

/* Ensure sidebar toggle visible and theme-aware */
.sidebar-toggle{color:var(--text);background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.06)}
:root[data-theme="dark"] .sidebar-toggle{color:#fff}
:root:not([data-theme="dark"]) .sidebar-toggle{color:#071023}

/* Increase sidebar spaciousness - ensure no scrollbar required */
.sidebar{padding:40px;gap:24px}
.sidebar-content{gap:22px}
.history-item{padding:18px}

/* Icon buttons: liquid glass action buttons next to input */
.icon-btn, .send{min-width:44px;height:44px;display:inline-flex;align-items:center;justify-content:center;border-radius:12px;background:linear-gradient(135deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.06);backdrop-filter:blur(12px);box-shadow:0 12px 50px rgba(0,0,0,0.08);cursor:pointer;transition:transform 220ms,box-shadow 220ms,background 220ms}
.icon-btn:hover, .send:hover{transform:translateY(-4px);box-shadow:0 30px 120px rgba(99,102,241,0.12);background:linear-gradient(135deg,rgba(255,255,255,0.06),rgba(255,255,255,0.03))}

/* Theme-aware icon color so glyphs are visible */
.icon-btn, .send{color:var(--text)}
:root[data-theme="dark"] .icon-btn, :root[data-theme="dark"] .send{color:#ffffff;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(135deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01))}

/* Make send button visually distinct with accent glow */
.send{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;border:none;box-shadow:0 20px 80px rgba(99,102,241,0.12)}
.send:hover{box-shadow:0 36px 160px rgba(99,102,241,0.18);transform:translateY(-4px) scale(1.03)}

/* Ensure input and buttons visually align */
.input{padding-right:12px}

/* Sidebar: center all content vertically & horizontally */
.sidebar{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:40px;gap:22px}
.sidebar-content{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;overflow:visible;padding-right:0;width:100%}
.history-list{display:flex;flex-direction:column;align-items:center;gap:14px;width:100%;max-width:320px}
.history-item{width:100%;box-sizing:border-box}
.sidebar-footer{display:flex;gap:12px;align-items:center;justify-content:center;padding-top:12px;width:100%}

/* Simplify button visuals: remove gradient outline pseudo-elements and keep clean liquid-glass hover */
.btn-primary::before, .btn-clear::before, .btn-primary::after, .btn-clear::after, .send::before, .send::after {
  display: none; /* remove decorative pseudo-elements for elegant, clean look */
}

/* Keep base button styles but tone down hover to gentle lift and glow */
.btn-primary, .btn-clear{
  transition: transform 220ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms, background 220ms;
}
.btn-primary:hover, .btn-clear:hover{
  transform: translateY(-4px);
  box-shadow: 0 22px 100px rgba(99,102,241,0.10);
}

/* Make Clear button text always white for visibility */
.btn-clear{ color: #ffffff !important; }
:root:not([data-theme="dark"]) .btn-clear{ color: #ffffff !important; }

/* Slightly smaller language buttons so they fit neatly */
.lang-toggle button{ padding:6px 10px; font-size:13px; }

.lang-toggle button[data-lang="English"]{ width:88px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }

/* Dropdown text in dark mode should be white for readability */
:root[data-theme="dark"] .select{ color: #ffffff; border-color: rgba(255,255,255,0.06); }
:root[data-theme="dark"] .select option{ color: #ffffff; background: rgba(8,12,16,0.92); }

:root:not([data-theme="dark"]) .select{ color: var(--text); background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)) }
:root:not([data-theme="dark"]) .select option{ color: #071023; background: #ffffff }

/* Ensure sidebar content doesn't overflow */
.sidebar-content{overflow:visible}

/* Sidebar: layered translucent gradients for strong liquid-glass look */
.sidebar{
  background: linear-gradient(180deg, rgba(139,92,246,0.06), rgba(6,182,212,0.03)), linear-gradient(180deg, var(--panel), var(--panel-2));
  border: 1px solid rgba(255,255,255,0.06);
  box-shadow: var(--shadow);
}

/* Restore button gradients and ensure white text */
.btn-primary, .btn-clear {
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
  color: #ffffff !important;
  border: none;
  box-shadow: 0 18px 80px rgba(99,102,241,0.10);
}
.btn-clear { /* keep visual parity with primary */
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
  color: #ffffff !important;
}
.btn-primary:hover, .btn-clear:hover {
  transform: translateY(-4px);
  box-shadow: 0 28px 120px rgba(99,102,241,0.12);
}

/* Language buttons: slightly smaller width, a touch larger visually, centered */
.lang-toggle{justify-content:center}
.lang-toggle button{padding:8px 12px;font-size:14px;min-width:64px;max-width:88px;display:inline-flex;align-items:center;justify-content:center}
.lang-toggle button[data-lang="English"]{width:78px}
.lang-toggle button[data-lang="Sinhala"]{width:78px}

/* Ensure select dropdown styling adapts in dark and light modes (reinforce) */
:root[data-theme="dark"] .select{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:#ffffff}
:root:not([data-theme="dark"]) .select{background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));color:#071023}

/* Enhanced theme toggle with smooth cross-fade */
.theme-transition *{
  transition:background-color 600ms cubic-bezier(.2,.9,.3,1),
             color 600ms cubic-bezier(.2,.9,.3,1),
             border-color 600ms cubic-bezier(.2,.9,.3,1),
             box-shadow 600ms cubic-bezier(.2,.9,.3,1),
             transform 600ms cubic-bezier(.2,.9,.3,1) !important;
}

/* Theme toggle animation overlay */
.app::before{
  content:'';
  position:fixed;
  inset:0;
  background:radial-gradient(circle at center, transparent 0%, rgba(99,102,241,0.1) 100%);
  opacity:0;
  pointer-events:none;
  transition:opacity 600ms cubic-bezier(.2,.9,.3,1);
  z-index:999;
}
.theme-transition .app::before{opacity:1}

/* Sync chat area expansion with sidebar hide/show (desktop only) */
@media (min-width:900px){
  /* Ensure a sidebar width variable exists and app transitions grid columns */
  .app{ --sidebar-w:360px; transition: grid-template-columns 420ms cubic-bezier(.2,.9,.3,1); }

  /* Animate chat width based on sidebar variable */
  .chat{
    /* Fill the grid's 1fr column instead of using a calc() width */
    width:100% !important;
    min-width:0; /* allow the chat to shrink inside the grid */
    max-width:none;
    justify-self:stretch;
    align-self:stretch;
  }

  /* When app has the sidebar-hidden state, collapse the sidebar column so chat grows */
  .app.sidebar-hidden{
    grid-template-columns: 0px 1fr;
  }
}

/* Mobile: chat should always be full width */
@media (max-width:899px){
  .chat{ width:100%; }
}

/* Chat bubble entry animation (already added class hooks) */
.msg.enter{opacity:0;transform:translateY(14px) scale(.98)}
.msg.enter.show{opacity:1;transform:none;transition:opacity 420ms cubic-bezier(.2,.9,.3,1),transform 420ms cubic-bezier(.2,.9,.3,1)}

/* Dropdown fade/scale (for selects using a small scale on focus) */
.select{transition:box-shadow 260ms, transform 260ms}
.select:focus{transform:scale(1.02)}

/* Buttons shimmer/glow: restore subtle shimmer on hover */
.btn-primary{position:relative;overflow:hidden}
.btn-primary::after{content:'';position:absolute;left:-120%;top:0;height:100%;width:220%;background:linear-gradient(90deg,rgba(255,255,255,0.06),rgba(255,255,255,0.12),rgba(255,255,255,0.06));transform:skewX(-18deg);opacity:0;transition:opacity 420ms,transform 420ms}
.btn-primary:hover::after{left: -20%;opacity:1;transform:skewX(-18deg) translateX(0)}

/* Sidebar show/hide smooth animation already handled by grid-template-columns transition; add overlay glow during transition */
.app.sidebar-hidden .chat{transition:margin-left 420ms cubic-bezier(.2,.9,.3,1)}

/* Ensure reduced-motion disables these fancy animations */
@media (prefers-reduced-motion: reduce){
  .theme-transition *{transition:none}
  .msg.enter.show{transition:none}
  .btn-primary::after{transition:none;opacity:0}
}

/* === Button hover normalization: single smooth move-up (no animations/transparency) === */
/* Hide decorative pseudo-elements used for shimmer/outline */
.btn-primary::before, .btn-primary::after,
.btn-clear::before, .btn-clear::after,
.send::before, .send::after,
.icon-btn::before, .icon-btn::after,
.sidebar-toggle::before, .sidebar-toggle::after,
.lang-toggle button::before, .lang-toggle button::after {
  display: none !important;
  content: none !important;
}

/* Ensure gradients remain visible for primary-like buttons */
.btn-primary, .btn-clear, .send, .icon-btn, .sidebar-toggle, .lang-toggle button {
  /* smooth transform transition for hover in/out */
  transition: transform 260ms cubic-bezier(.2,.9,.3,1), box-shadow 260ms ease;
  /* remove any CSS animation to prevent double effects */
  animation: none !important;
}

/* Explicitly preserve gradient backgrounds (do not allow hover rules to clear them) */
.btn-primary { background-image: linear-gradient(90deg, var(--accent1), var(--accent2)) !important; }
.btn-clear  { background-image: linear-gradient(90deg, var(--accent1), var(--accent2)) !important; }
.send       { background-image: linear-gradient(90deg, var(--accent1), var(--accent2)) !important; }
.icon-btn, .sidebar-toggle, .lang-toggle button { background-image: none; /* keep their existing background rules */ }

/* Single subtle move-up on hover; on leave it will transition back */
.btn-primary:hover,
.btn-clear:hover,
.send:hover,
.icon-btn:hover,
.sidebar-toggle:hover,
.lang-toggle button:hover {
  transform: translateY(-6px) !important;
  /* Preserve box-shadow and gradient; do not change opacity or background */
  animation: none !important;
}

/* Respect reduced motion preference */
@media (prefers-reduced-motion: reduce){
  .btn-primary, .btn-clear, .send, .icon-btn, .sidebar-toggle, .lang-toggle button {
    transition: none !important;
  }
  .btn-primary:hover, .btn-clear:hover, .send:hover, .icon-btn:hover, .sidebar-toggle:hover, .lang-toggle button:hover {
    transform: none !important; animation: none !important;
  }
}

/* === Animation smoothing tweaks === */
/* Promote animated layers to GPU and give the browser hints for smoother transitions */
.app{
  will-change: grid-template-columns, transform;
  backface-visibility: hidden;
  transform: translateZ(0);
  /* slightly snappier, smoother easing for the grid column transition */
  transition: grid-template-columns 360ms cubic-bezier(.2,.9,.25,1);
}

.sidebar{
  will-change: transform, opacity;
  backface-visibility: hidden;
  transform: translateZ(0);
  transition: transform 360ms cubic-bezier(.2,.9,.25,1), opacity 300ms ease;
}

.chat{
  will-change: width, transform;
  backface-visibility: hidden;
  transform: translateZ(0);
  transition: width 360ms cubic-bezier(.2,.9,.25,1), transform 360ms cubic-bezier(.2,.9,.25,1);
}

.messages{
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* Button shimmer optimization */
.btn-primary::after{
  will-change: opacity, transform;
  transition: opacity 360ms ease, transform 360ms ease;
}

/* Make box-shadow transitions slightly faster to reduce perceived lag */
.btn-primary, .btn-clear, .send, .icon-btn, .sidebar-toggle{
  transition: transform 260ms cubic-bezier(.2,.9,.25,1), box-shadow 260ms ease, background 260ms ease;
}

@media (prefers-reduced-motion: reduce){
  .app, .sidebar, .chat, .messages, .btn-primary::after, .btn-primary, .btn-clear, .send, .icon-btn, .sidebar-toggle {
    transition: none !important;
    animation: none !important;
    will-change: auto !important;
  }
}
/* === End smoothing tweaks === */
